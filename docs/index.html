<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quality Control of Sequencing Data • fastqcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Quality Control of Sequencing Data">
<meta property="og:description" content="FASTQC is the most widely used tool for evaluating the quality of high throughput sequencing data.  
    It produces, for each sample, an html report and a compressed file containing the raw data. 
    If you have hundreds of samples, you are not going to open up each HTML page. 
    You need some way of looking at these data in aggregate. 
    fastqcr Provides helper functions to easily parse, aggregate and analyze 
    FastQC reports for large numbers of samples. It provides a convenient solution for building 
    a Multi-QC report, as well as, a one-sample report with result interpretations.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fastqcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    QC Reports
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="qc-reports/fastqcr-multi-qc-report.html">Multi-QC Reports</a>
    </li>
    <li>
      <a href="qc-reports/sample-qc-report-interpretation.html">One-Sample Report (+Interpretation)</a>
    </li>
    <li>
      <a href="qc-reports/sample-qc-report-without-interpretation.html">One-Sample Report (no interpretation)</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kassambara/fastqcr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<p><br></p>
<style>
.error,.notice,.warning,.success,.question{height:auto;padding:10px 10px 10px 40px;margin:5px auto 15px;line-height:20px;border:1px solid #FFF;border-radius:4px;position:relative;display:block;text-align:left}.question{background-color:#DAEEF8;border-color:#BDE9F2}.notice{background-color:#F0F0F0;border-color:#E2E2E2}.warning{background-color:#FDF9E4;border-color:#FBECCD}.error{background-color:#F3DFDF;border-color:#ECCDD2}.success{background-color:#E0F1D9;border-color:#D7EAC7}.block,.medium-block,.small-block{border:1px solid #CCC;border-top:2px solid #366393;border-bottom:1px solid #99B1CB;background:#F2F8FF;padding:10px}.block{width:auto;margin-top:10px;margin-bottom:10px}img{background-color:#fff;background-color:#FFF;border-radius:3px;border:1px solid #CCC;box-shadow:2px 2px 12px -5px #999;margin:0 5px;margin-bottom:5px;padding:5px;text-align:center}
</style>
<div class="section level1">
<div class="page-header"><h1 id="fastqcr-quality-control-of-sequencing-data">fastqcr: Quality Control of Sequencing Data<a class="anchor" aria-label="anchor" href="#fastqcr-quality-control-of-sequencing-data"></a>
</h1></div>
<p>The FastQC, written by Simon Andrews at the Babraham Institute, is the most widely used sequence quality assessment tool for evaluating the raw reads from high throughput sequencing data.</p>
<p>It produces, for each sample, an html report and a ‘zip’ file, which contains a file called fastqc_data.txt and summary.txt.</p>
<p>If you have hundreds of samples, you’re not going to open up each HTML page. You need some way of looking at these data in aggregate.</p>
<p>The <strong>fastqcr</strong> R package provides helper functions to easily and automatically parse, aggregate and analyze FastQC reports for large numbers of samples.</p>
<p>Additionally, the <strong>fastqcr</strong> package provides a convenient solution for building a multi-QC report and a one-sample FastQC report with the result interpretations. The online documentation is available at: <a href="http://www.sthda.com/english/rpkgs/fastqcr/" class="external-link uri">http://www.sthda.com/english/rpkgs/fastqcr/</a>.</p>
<p>Examples of QC reports, generated automatically by the <strong>fastqcr</strong> R package, include:</p>
<ul>
<li><a href="http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/fastqcr-multi-qc-report.html" class="external-link">Multi-QC report for multiple samples</a></li>
<li><a href="http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/sample-qc-report-interpretation.html" class="external-link">One sample QC report (+ interpretation)</a></li>
<li><a href="http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/sample-qc-report-without-interpretation.html" class="external-link">One sample QC report (no interpretation)</a></li>
</ul>
<div class="figure">
<img src="tools/fastqcr.png" alt=""><p class="caption">fastqcr logo</p>
</div>
<div class="section level2">
<h2 id="installation-and-loading">Installation and loading<a class="anchor" aria-label="anchor" href="#installation-and-loading"></a>
</h2>
<ul><li>fastqcr can be installed from <a href="https://cran.r-project.org/package=fastqcr" class="external-link">CRAN</a> as follow:</li></ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fastqcr"</span><span class="op">)</span></span></code></pre></div>
<ul><li>Or, install the latest version from <a href="https://github.com/kassambara/fastqcr" class="external-link">GitHub</a>:</li></ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"kassambara/fastqcr"</span><span class="op">)</span></span></code></pre></div>
<ul><li>Load fastqcr:</li></ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://www.sthda.com/english/rpkgs/fastqcr/" class="external-link">"fastqcr"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/fastqcr/" class="external-link">fastqcr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggregating Multiple FastQC Reports into a Data Frame </span></span>
<span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span></span>
<span><span class="co"># Demo QC directory containing zipped FASTQC reports</span></span>
<span><span class="va">qc.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fastqc_results"</span>, package <span class="op">=</span> <span class="st">"fastqcr"</span><span class="op">)</span></span>
<span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/qc_aggregate.html">qc_aggregate</a></span><span class="op">(</span><span class="va">qc.dir</span><span class="op">)</span></span>
<span><span class="va">qc</span></span>
<span></span>
<span><span class="co"># Inspecting QC Problems</span></span>
<span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span></span>
<span><span class="co"># See which modules failed in the most samples</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_fails</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span><span class="op">)</span></span>
<span><span class="co"># Or, see which samples failed the most</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_fails</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"sample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Building Multi QC Reports</span></span>
<span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span><span class="fu"><a href="reference/qc_report.html">qc_report</a></span><span class="op">(</span><span class="va">qc.dir</span>, result.file <span class="op">=</span> <span class="st">"multi-qc-report"</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Building One-Sample QC Reports (+ Interpretation)</span></span>
<span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span><span class="va">qc.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fastqc_results"</span>, <span class="st">"S1_fastqc.zip"</span>, package <span class="op">=</span> <span class="st">"fastqcr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/qc_report.html">qc_report</a></span><span class="op">(</span><span class="va">qc.file</span>, result.file <span class="op">=</span> <span class="st">"one-sample-report"</span>,</span>
<span>          interpret <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="main-functions">Main Functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<p><strong>1) Installing and Running FastQC</strong></p>
<ul>
<li><p><strong>fastqc_install</strong>(): Install the latest version of FastQC tool on Unix systems (MAC OSX and Linux)</p></li>
<li><p><strong>fastqc</strong>(): Run the FastQC tool from R.</p></li>
</ul>
<p><strong>2) Aggregating and Summarizing Multiple FastQC Reports</strong></p>
<ul>
<li><p><strong>qc &lt;- qc_aggregate</strong>(): Aggregate multiple FastQC reports into a data frame.</p></li>
<li><p><strong>summary</strong>(qc): Generates a summary of qc_aggregate.</p></li>
<li><p><strong>qc_stats</strong>(qc): General statistics of FastQC reports.</p></li>
</ul>
<p><strong>3) Inspecting Problems</strong></p>
<ul>
<li><p><strong>qc_fails</strong>(qc): Displays samples or modules that failed.</p></li>
<li><p><strong>qc_warns</strong>(qc): Displays samples or modules that warned.</p></li>
<li><p><strong>qc_problems</strong>(qc): Union of <strong>qc_fails</strong>() and <strong>qc_warns</strong>(). Display which samples or modules that failed or warned.</p></li>
</ul>
<p><strong>4) Importing and Plotting FastQC Reports</strong></p>
<ul>
<li><p><strong>qc_read</strong>(): Read FastQC data into R.</p></li>
<li><p><strong>qc_plot</strong>(qc): Plot FastQC data</p></li>
</ul>
<p><strong>5) Building One-Sample and Multi-QC Reports</strong></p>
<ul><li>
<strong>qc_report</strong>(): Create an HTML file containing FastQC reports of one or multiple files. Inputs can be either a directory containing multiple FastQC reports or a single sample FastQC report.</li></ul>
<p><strong>6) Others</strong></p>
<ul><li>
<strong>qc_unzip</strong>(): Unzip all zipped files in the qc.dir directory. <br>
</li></ul>
</div>
<div class="section level2">
<h2 id="installing-fastqc-from-r">Installing FastQC from R<a class="anchor" aria-label="anchor" href="#installing-fastqc-from-r"></a>
</h2>
<p>You can install automatically the FastQC tool from R as follow:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/fastqc_install.html">fastqc_install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-fastqc-from-r">Running FastQC from R<a class="anchor" aria-label="anchor" href="#running-fastqc-from-r"></a>
</h2>
<p>The supported <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/2%20Basic%20Operations/2.1%20Opening%20a%20sequence%20file.html" class="external-link">file formats</a> by FastQC include:</p>
<ul>
<li>FASTQ</li>
<li>gzip compressed FASTQ</li>
</ul>
<p>Suppose that your working directory is organized as follow:</p>
<ul><li>home<ul><li>Documents<ul><li>FASTQ</li></ul>
</li></ul>
</li></ul>
<p>where, FASTQ is the directory containing your FASTQ files, for which you want to perform the quality control check.</p>
<p>To run FastQC from R, type this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/fastqc.html">fastqc</a></span><span class="op">(</span>fq.dir <span class="op">=</span> <span class="st">"~/Documents/FASTQ"</span>, <span class="co"># FASTQ files directory</span></span>
<span>       qc.dir <span class="op">=</span> <span class="st">"~/Documents/FASTQC"</span>, <span class="co"># Results direcory</span></span>
<span>       threads <span class="op">=</span> <span class="fl">4</span>                    <span class="co"># Number of threads</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fastqc-reports">FastQC Reports<a class="anchor" aria-label="anchor" href="#fastqc-reports"></a>
</h2>
<p>For each sample, FastQC performs a series of tests called <em>analysis modules</em>.</p>
<p>These modules include:</p>
<ul>
<li>Basic Statistics,</li>
<li>Per base sequence quality,</li>
<li>Per tile sequence quality</li>
<li>Per sequence quality scores,</li>
<li>Per base sequence content,</li>
<li>Per sequence GC content,</li>
<li>Per base N content,</li>
<li>Sequence Length Distribution,</li>
<li>Sequence Duplication Levels,</li>
<li>Overrepresented sequences,</li>
<li>Adapter Content</li>
<li>Kmer content</li>
</ul>
<p>The interpretation of these modules are provided in the official documentation of the <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/" class="external-link">FastQC tool</a>.</p>
</div>
<div class="section level2">
<h2 id="aggregating-reports">Aggregating Reports<a class="anchor" aria-label="anchor" href="#aggregating-reports"></a>
</h2>
<p>Here, we provide an R function <strong>qc_aggregate()</strong> to walk the FastQC result directory, find all the FASTQC zipped output folders, read the <strong>fastqc_data.txt</strong> and the <strong>summary.txt</strong> files, and aggregate the information into a data frame.</p>
<p>In the example below, we’ll use a demo FastQC output directory available in the fastqcr package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/fastqcr/" class="external-link">fastqcr</a></span><span class="op">)</span></span>
<span><span class="co"># Demo QC dir</span></span>
<span><span class="va">qc.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fastqc_results"</span>, package <span class="op">=</span> <span class="st">"fastqcr"</span><span class="op">)</span></span>
<span><span class="va">qc.dir</span></span>
<span><span class="co"># [1] "/Library/Frameworks/R.framework/Versions/3.3/Resources/library/fastqcr/fastqc_results"</span></span>
<span>   </span>
<span><span class="co"># List of files in the directory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">qc.dir</span><span class="op">)</span></span>
<span><span class="co"># [1] "S1_fastqc.zip" "S2_fastqc.zip" "S3_fastqc.zip" "S4_fastqc.zip"</span></span>
<span><span class="co"># [5] "S5_fastqc.zip"</span></span></code></pre></div>
<p>The demo QC directory contains five zipped folders corresponding to the FastQC output for 5 samples.</p>
<p>Aggregating FastQC reports:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/qc_aggregate.html">qc_aggregate</a></span><span class="op">(</span><span class="va">qc.dir</span><span class="op">)</span></span>
<span><span class="va">qc</span></span></code></pre></div>
<p>The aggregated report looks like this:</p>
<table class="table">
<thead><tr class="header">
<th align="left">sample</th>
<th align="left">module</th>
<th align="left">status</th>
<th align="left">tot.seq</th>
<th align="left">seq.length</th>
<th align="right">pct.gc</th>
<th align="right">pct.dup</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S3</td>
<td align="left">Per base sequence content</td>
<td align="left">FAIL</td>
<td align="left">67255341</td>
<td align="left">35-76</td>
<td align="right">49</td>
<td align="right">22.14</td>
</tr>
<tr class="even">
<td align="left">S5</td>
<td align="left">Per sequence GC content</td>
<td align="left">WARN</td>
<td align="left">65011962</td>
<td align="left">35-76</td>
<td align="right">48</td>
<td align="right">18.15</td>
</tr>
<tr class="odd">
<td align="left">S3</td>
<td align="left">Overrepresented sequences</td>
<td align="left">PASS</td>
<td align="left">67255341</td>
<td align="left">35-76</td>
<td align="right">49</td>
<td align="right">22.14</td>
</tr>
<tr class="even">
<td align="left">S3</td>
<td align="left">Per tile sequence quality</td>
<td align="left">PASS</td>
<td align="left">67255341</td>
<td align="left">35-76</td>
<td align="right">49</td>
<td align="right">22.14</td>
</tr>
<tr class="odd">
<td align="left">S4</td>
<td align="left">Per sequence quality scores</td>
<td align="left">PASS</td>
<td align="left">67255341</td>
<td align="left">35-76</td>
<td align="right">49</td>
<td align="right">19.89</td>
</tr>
<tr class="even">
<td align="left">S1</td>
<td align="left">Per sequence GC content</td>
<td align="left">WARN</td>
<td align="left">50299587</td>
<td align="left">35-76</td>
<td align="right">48</td>
<td align="right">17.24</td>
</tr>
<tr class="odd">
<td align="left">S5</td>
<td align="left">Kmer Content</td>
<td align="left">PASS</td>
<td align="left">65011962</td>
<td align="left">35-76</td>
<td align="right">48</td>
<td align="right">18.15</td>
</tr>
<tr class="even">
<td align="left">S3</td>
<td align="left">Sequence Duplication Levels</td>
<td align="left">PASS</td>
<td align="left">67255341</td>
<td align="left">35-76</td>
<td align="right">49</td>
<td align="right">22.14</td>
</tr>
<tr class="odd">
<td align="left">S1</td>
<td align="left">Basic Statistics</td>
<td align="left">PASS</td>
<td align="left">50299587</td>
<td align="left">35-76</td>
<td align="right">48</td>
<td align="right">17.24</td>
</tr>
<tr class="even">
<td align="left">S1</td>
<td align="left">Overrepresented sequences</td>
<td align="left">PASS</td>
<td align="left">50299587</td>
<td align="left">35-76</td>
<td align="right">48</td>
<td align="right">17.24</td>
</tr>
</tbody>
</table>
<p>Column names:</p>
<ul>
<li>
<strong>sample</strong>: sample names</li>
<li>
<strong>module</strong>: fastqc modules</li>
<li>
<strong>status</strong>: fastqc module status for each sample</li>
<li>
<strong>tot.seq</strong>: total sequences (i.e.: the number of reads)</li>
<li>
<strong>seq.length</strong>: sequence length</li>
<li>
<strong>pct.gc</strong>: percentage of GC content</li>
<li>
<strong>pct.dup</strong>: percentage of duplicate reads</li>
</ul>
<p>The table shows, for each sample, the names of tested FastQC modules, the status of the test, as well as, some general statistics including the number of reads, the length of reads, the percentage of GC content and the percentage of duplicate reads.</p>
<p>Once you have the aggregated data you can use the <strong>dplyr</strong> package to easily inspect modules that failed or warned in samples. For example, the following R code shows samples with warnings and/or failures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">qc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">module</span>, <span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>    </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">status</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WARN"</span>, <span class="st">"FAIL"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 15 x 3</span></span>
<span><span class="co">#    sample module                       status</span></span>
<span><span class="co">#    &lt;chr&gt;  &lt;chr&gt;                        &lt;chr&gt; </span></span>
<span><span class="co">#  1 S1     Per base sequence content    FAIL  </span></span>
<span><span class="co">#  2 S1     Per sequence GC content      WARN  </span></span>
<span><span class="co">#  3 S1     Sequence Length Distribution WARN  </span></span>
<span><span class="co">#  4 S2     Per base sequence content    FAIL  </span></span>
<span><span class="co">#  5 S2     Per sequence GC content      WARN  </span></span>
<span><span class="co">#  6 S2     Sequence Length Distribution WARN  </span></span>
<span><span class="co">#  7 S3     Per base sequence content    FAIL  </span></span>
<span><span class="co">#  8 S3     Per sequence GC content      FAIL  </span></span>
<span><span class="co">#  9 S3     Sequence Length Distribution WARN  </span></span>
<span><span class="co"># 10 S4     Per base sequence content    FAIL  </span></span>
<span><span class="co"># 11 S4     Per sequence GC content      FAIL  </span></span>
<span><span class="co"># 12 S4     Sequence Length Distribution WARN  </span></span>
<span><span class="co"># 13 S5     Per base sequence content    FAIL  </span></span>
<span><span class="co"># 14 S5     Per sequence GC content      WARN  </span></span>
<span><span class="co"># 15 S5     Sequence Length Distribution WARN</span></span></code></pre></div>
<p>In the next section, we’ll describe some easy-to-use functions, available in the <strong>fastqcr</strong> package, for analyzing the aggregated data.</p>
</div>
<div class="section level2">
<h2 id="summarizing-reports">Summarizing Reports<a class="anchor" aria-label="anchor" href="#summarizing-reports"></a>
</h2>
<p>We start by presenting a summary and general statistics of the aggregated data.</p>
<div class="section level3">
<h3 id="qc-summary">QC Summary<a class="anchor" aria-label="anchor" href="#qc-summary"></a>
</h3>
<ul>
<li>R function: <strong>summary</strong>()</li>
<li>Input data: aggregated data from <strong>qc_aggregate</strong>()</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of qc</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">qc</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 12 x 7</span></span>
<span><span class="co"># # Groups:   module [?]</span></span>
<span><span class="co">#    module         nb_samples nb_fail nb_pass nb_warn failed     warned    </span></span>
<span><span class="co">#    &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     </span></span>
<span><span class="co">#  1 Adapter Conte…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co">#  2 Basic Statist…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co">#  3 Kmer Content            5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co">#  4 Overrepresent…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co">#  5 Per base N co…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co">#  6 Per base sequ…          5       5       0       0 S1, S2, S… &lt;NA&gt;      </span></span>
<span><span class="co">#  7 Per base sequ…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co">#  8 Per sequence …          5       2       0       3 S3, S4     S1, S2, S5</span></span>
<span><span class="co">#  9 Per sequence …          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co"># 10 Per tile sequ…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co"># 11 Sequence Dupl…          5       0       5       0 &lt;NA&gt;       &lt;NA&gt;      </span></span>
<span><span class="co"># 12 Sequence Leng…          5       0       0       5 &lt;NA&gt;       S1, S2, S…</span></span></code></pre></div>
<p>Column names:</p>
<ul>
<li>
<em>module</em>: fastqc modules</li>
<li>
<em>nb_samples</em>: the number of samples tested</li>
<li>
<em>nb_pass, nb_fail, nb_warn</em>: the number of samples that passed, failed and warned, respectively.</li>
<li>
<em>failed, warned</em>: the name of samples that failed and warned, respectively.</li>
</ul>
<p>The table shows, for each FastQC module, the number and the name of samples that failed or warned.</p>
</div>
<div class="section level3">
<h3 id="general-statistics">General statistics<a class="anchor" aria-label="anchor" href="#general-statistics"></a>
</h3>
<ul>
<li>R function: <strong>qc_stats</strong>()</li>
<li>Input data: aggregated data from <strong>qc_aggregate</strong>()</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/qc_aggregate.html">qc_stats</a></span><span class="op">(</span><span class="va">qc</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 5 x 5</span></span>
<span><span class="co">#   sample pct.dup pct.gc tot.seq  seq.length</span></span>
<span><span class="co">#   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;     </span></span>
<span><span class="co"># 1 S1        17.2     48 50299587 35-76     </span></span>
<span><span class="co"># 2 S2        15.7     48 50299587 35-76     </span></span>
<span><span class="co"># 3 S3        22.1     49 67255341 35-76     </span></span>
<span><span class="co"># 4 S4        19.9     49 67255341 35-76     </span></span>
<span><span class="co"># 5 S5        18.2     48 65011962 35-76</span></span></code></pre></div>
<p>Column names:</p>
<ul>
<li>
<em>pct.dup</em>: the percentage of duplicate reads,</li>
<li>
<em>pct.gc</em>: the percentage of GC content,</li>
<li>
<em>tot.seq</em>: total sequences or the number of reads and</li>
<li>
<em>seq.length</em>: sequence length or the length of reads.</li>
</ul>
<p>The table shows, for each sample, some general statistics such as the total number of reads, the length of reads, the percentage of GC content and the percentage of duplicate reads</p>
</div>
</div>
<div class="section level2">
<h2 id="inspecting-problems">Inspecting Problems<a class="anchor" aria-label="anchor" href="#inspecting-problems"></a>
</h2>
<p>Once you’ve got this aggregated data, it’s easy to figure out what (if anything) is wrong with your data.</p>
<p><strong>1) R functions</strong>. You can inspect problems per either modules or samples using the following R functions:</p>
<ul>
<li>
<strong>qc_fails</strong>(qc): Displays samples or modules that failed.</li>
<li>
<strong>qc_warns</strong>(qc): Displays samples or modules that warned.</li>
<li>
<strong>qc_problems</strong>(qc): Union of <strong>qc_fails</strong>() and <strong>qc_warns</strong>(). Display which samples or modules that failed or warned.</li>
</ul>
<p><strong>2) Input data</strong>: aggregated data from <strong>qc_aggregate</strong>()</p>
<p><strong>3) Output data</strong>: Returns samples or FastQC modules with failures or warnings. By default, these functions return a compact output format. If you want a stretched format, specify the argument <em>compact = FALSE</em>.</p>
<p>The format and the interpretation of the outputs depend on the additional argument <em>element</em>, which value is one of c(“sample”, “module”).</p>
<ul>
<li>If <strong>element = “sample”</strong> (default), results are samples with failed and/or warned modules. The results contain the following columns:<ul>
<li>sample (sample names),</li>
<li>nb_problems (the number of modules with problems),</li>
<li>module (the name of modules with problems).</li>
</ul>
</li>
<li>If <strong>element = “module”</strong>, results are modules that failed and/or warned in the most samples. The results contain the following columns:<ul>
<li>module (the name of module with problems),</li>
<li>nb_problems (the number of samples with problems),</li>
<li>sample (the name of samples with problems)</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="per-module-problems">Per Module Problems<a class="anchor" aria-label="anchor" href="#per-module-problems"></a>
</h3>
<ul><li>
<strong>Modules that failed in the most samples</strong>:</li></ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See which module failed in the most samples</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_fails</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 2 x 3</span></span>
<span><span class="co">#   module                    nb_problems sample            </span></span>
<span><span class="co">#   &lt;chr&gt;                           &lt;int&gt; &lt;chr&gt;             </span></span>
<span><span class="co"># 1 Per base sequence content           5 S1, S2, S3, S4, S5</span></span>
<span><span class="co"># 2 Per sequence GC content             2 S3, S4</span></span></code></pre></div>
<p>For each module, the number of problems (failures) and the name of samples, that failed, are shown.</p>
<ul><li>
<strong>Modules that warned in the most samples</strong>:</li></ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See which module warned in the most samples</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_warns</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 2 x 3</span></span>
<span><span class="co">#   module                       nb_problems sample            </span></span>
<span><span class="co">#   &lt;chr&gt;                              &lt;int&gt; &lt;chr&gt;             </span></span>
<span><span class="co"># 1 Sequence Length Distribution           5 S1, S2, S3, S4, S5</span></span>
<span><span class="co"># 2 Per sequence GC content                3 S1, S2, S5</span></span></code></pre></div>
<ul><li>
<strong>Modules that failed or warned</strong>: Union of qc_fails() and qc_warns()</li></ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See which modules failed or warned.</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_problems</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 3 x 3</span></span>
<span><span class="co">#   module                       nb_problems sample            </span></span>
<span><span class="co">#   &lt;chr&gt;                              &lt;int&gt; &lt;chr&gt;             </span></span>
<span><span class="co"># 1 Per base sequence content              5 S1, S2, S3, S4, S5</span></span>
<span><span class="co"># 2 Per sequence GC content                5 S1, S2, S3, S4, S5</span></span>
<span><span class="co"># 3 Sequence Length Distribution           5 S1, S2, S3, S4, S5</span></span></code></pre></div>
<p>The output above is in a compact format. For a stretched format, type this:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/qc_problems.html">qc_problems</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span>, compact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 15 x 4</span></span>
<span><span class="co">#    module                       nb_problems sample status</span></span>
<span><span class="co">#    &lt;chr&gt;                              &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; </span></span>
<span><span class="co">#  1 Per base sequence content              5 S1     FAIL  </span></span>
<span><span class="co">#  2 Per base sequence content              5 S2     FAIL  </span></span>
<span><span class="co">#  3 Per base sequence content              5 S3     FAIL  </span></span>
<span><span class="co">#  4 Per base sequence content              5 S4     FAIL  </span></span>
<span><span class="co">#  5 Per base sequence content              5 S5     FAIL  </span></span>
<span><span class="co">#  6 Per sequence GC content                5 S3     FAIL  </span></span>
<span><span class="co">#  7 Per sequence GC content                5 S4     FAIL  </span></span>
<span><span class="co">#  8 Per sequence GC content                5 S1     WARN  </span></span>
<span><span class="co">#  9 Per sequence GC content                5 S2     WARN  </span></span>
<span><span class="co"># 10 Per sequence GC content                5 S5     WARN  </span></span>
<span><span class="co"># 11 Sequence Length Distribution           5 S1     WARN  </span></span>
<span><span class="co"># 12 Sequence Length Distribution           5 S2     WARN  </span></span>
<span><span class="co"># 13 Sequence Length Distribution           5 S3     WARN  </span></span>
<span><span class="co"># 14 Sequence Length Distribution           5 S4     WARN  </span></span>
<span><span class="co"># 15 Sequence Length Distribution           5 S5     WARN</span></span></code></pre></div>
<p>In the the stretched format each row correspond to a unique sample. Additionally, the status of each module is specified.</p>
<p>It’s also possible to display problems for one or more specified modules. For example,</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/qc_problems.html">qc_problems</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span>,  name <span class="op">=</span> <span class="st">"Per sequence GC content"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 5 x 4</span></span>
<span><span class="co">#   module                  nb_problems sample status</span></span>
<span><span class="co">#   &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; </span></span>
<span><span class="co"># 1 Per sequence GC content           5 S3     FAIL  </span></span>
<span><span class="co"># 2 Per sequence GC content           5 S4     FAIL  </span></span>
<span><span class="co"># 3 Per sequence GC content           5 S1     WARN  </span></span>
<span><span class="co"># 4 Per sequence GC content           5 S2     WARN  </span></span>
<span><span class="co"># 5 Per sequence GC content           5 S5     WARN</span></span></code></pre></div>
<p>Note that, partial matching of name is allowed. For example, name = “Per sequence GC content” equates to name = “GC content”.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/qc_problems.html">qc_problems</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"module"</span>,  name <span class="op">=</span> <span class="st">"GC content"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="per-sample-problems">Per Sample Problems<a class="anchor" aria-label="anchor" href="#per-sample-problems"></a>
</h3>
<ul><li><strong>Samples with one or more failed modules</strong></li></ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See which samples had one or more failed modules</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_fails</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"sample"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 5 x 3</span></span>
<span><span class="co">#   sample nb_problems module                                            </span></span>
<span><span class="co">#   &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;                                             </span></span>
<span><span class="co"># 1 S3               2 Per base sequence content, Per sequence GC content</span></span>
<span><span class="co"># 2 S4               2 Per base sequence content, Per sequence GC content</span></span>
<span><span class="co"># 3 S1               1 Per base sequence content                         </span></span>
<span><span class="co"># 4 S2               1 Per base sequence content                         </span></span>
<span><span class="co"># 5 S5               1 Per base sequence content</span></span></code></pre></div>
<p>For each sample, the number of problems (failures) and the name of modules, that failed, are shown.</p>
<ul><li>
<strong>Samples with failed or warned modules</strong>:</li></ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See which samples had one or more module with failure or warning</span></span>
<span><span class="fu"><a href="reference/qc_problems.html">qc_problems</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"sample"</span>, compact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 15 x 4</span></span>
<span><span class="co">#    sample nb_problems module                       status</span></span>
<span><span class="co">#    &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;                        &lt;chr&gt; </span></span>
<span><span class="co">#  1 S1               3 Per base sequence content    FAIL  </span></span>
<span><span class="co">#  2 S1               3 Per sequence GC content      WARN  </span></span>
<span><span class="co">#  3 S1               3 Sequence Length Distribution WARN  </span></span>
<span><span class="co">#  4 S2               3 Per base sequence content    FAIL  </span></span>
<span><span class="co">#  5 S2               3 Per sequence GC content      WARN  </span></span>
<span><span class="co">#  6 S2               3 Sequence Length Distribution WARN  </span></span>
<span><span class="co">#  7 S3               3 Per base sequence content    FAIL  </span></span>
<span><span class="co">#  8 S3               3 Per sequence GC content      FAIL  </span></span>
<span><span class="co">#  9 S3               3 Sequence Length Distribution WARN  </span></span>
<span><span class="co"># 10 S4               3 Per base sequence content    FAIL  </span></span>
<span><span class="co"># 11 S4               3 Per sequence GC content      FAIL  </span></span>
<span><span class="co"># 12 S4               3 Sequence Length Distribution WARN  </span></span>
<span><span class="co"># 13 S5               3 Per base sequence content    FAIL  </span></span>
<span><span class="co"># 14 S5               3 Per sequence GC content      WARN  </span></span>
<span><span class="co"># 15 S5               3 Sequence Length Distribution WARN</span></span></code></pre></div>
<p>To specify the name of a sample of interest, type this:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/qc_problems.html">qc_problems</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"sample"</span>, name <span class="op">=</span> <span class="st">"S1"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 3 x 4</span></span>
<span><span class="co">#   sample nb_problems module                       status</span></span>
<span><span class="co">#   &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;                        &lt;chr&gt; </span></span>
<span><span class="co"># 1 S1               3 Per base sequence content    FAIL  </span></span>
<span><span class="co"># 2 S1               3 Per sequence GC content      WARN  </span></span>
<span><span class="co"># 3 S1               3 Sequence Length Distribution WARN</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="building-an-html-report">Building an HTML Report<a class="anchor" aria-label="anchor" href="#building-an-html-report"></a>
</h2>
<p>The function <strong>qc_report</strong>() can be used to build a report of FastQC outputs. It creates an HTML file containing FastQC reports of one or multiple samples.</p>
<p>Inputs can be either a directory containing multiple FastQC reports or a single sample FastQC report.</p>
<div class="section level3">
<h3 id="create-a-multi-qc-report">Create a Multi-QC Report<a class="anchor" aria-label="anchor" href="#create-a-multi-qc-report"></a>
</h3>
<p>We’ll build a multi-qc report for the following demo QC directory:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demo QC Directory</span></span>
<span><span class="va">qc.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fastqc_results"</span>, package <span class="op">=</span> <span class="st">"fastqcr"</span><span class="op">)</span></span>
<span><span class="va">qc.dir</span></span>
<span><span class="co"># [1] "/Library/Frameworks/R.framework/Versions/3.3/Resources/library/fastqcr/fastqc_results"</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build a report</span></span>
<span><span class="fu"><a href="reference/qc_report.html">qc_report</a></span><span class="op">(</span><span class="va">qc.dir</span>, result.file <span class="op">=</span> <span class="st">"~/Desktop/multi-qc-result"</span>,</span>
<span>          experiment <span class="op">=</span> <span class="st">"Exome sequencing of colon cancer cell lines"</span><span class="op">)</span></span></code></pre></div>
<p>An example of report is available at: &lt;a href= “<a href="http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/fastqcr-multi-qc-report.html" class="external-link uri">http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/fastqcr-multi-qc-report.html</a>”, target = "_blank"&gt; fastqcr multi-qc report</p>
</div>
<div class="section level3">
<h3 id="create-a-one-sample-report">Create a One-Sample Report<a class="anchor" aria-label="anchor" href="#create-a-one-sample-report"></a>
</h3>
<p>We’ll build a report for the following demo QC file:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">qc.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fastqc_results"</span>, <span class="st">"S1_fastqc.zip"</span>, package <span class="op">=</span> <span class="st">"fastqcr"</span><span class="op">)</span></span>
<span><span class="va">qc.file</span></span>
<span><span class="co"># [1] "/Library/Frameworks/R.framework/Versions/3.3/Resources/library/fastqcr/fastqc_results/S1_fastqc.zip"</span></span></code></pre></div>
<ul><li>
<strong>One-Sample QC report with plot interpretations</strong>:</li></ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="reference/qc_report.html">qc_report</a></span><span class="op">(</span><span class="va">qc.file</span>, result.file <span class="op">=</span> <span class="st">"one-sample-report-with-interpretation"</span>,</span>
<span>   interpret <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>An example of report is available at: &lt;a href= “<a href="http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/sample-qc-report-interpretation.html" class="external-link uri">http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/sample-qc-report-interpretation.html</a>”, target = "_blank"&gt; One sample QC report with interpretation</p>
<ul><li>
<strong>One-Sample QC report without plot interpretations</strong>:</li></ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="reference/qc_report.html">qc_report</a></span><span class="op">(</span><span class="va">qc.file</span>, result.file <span class="op">=</span> <span class="st">"one-sample-report"</span>,</span>
<span>   interpret <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>An example of report is available at: &lt;a href= “<a href="http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/sample-qc-report-without-interpretation.html" class="external-link uri">http://www.sthda.com/english/rpkgs/fastqcr/qc-reports/sample-qc-report-without-interpretation.html</a>”, target = "_blank"&gt; One sample QC report without interpretation</p>
</div>
</div>
<div class="section level2">
<h2 id="importing-and-plotting-a-fastqc-qc-report">Importing and Plotting a FastQC QC Report<a class="anchor" aria-label="anchor" href="#importing-and-plotting-a-fastqc-qc-report"></a>
</h2>
<p>We’ll visualize the output for sample 1:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demo file</span></span>
<span><span class="va">qc.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fastqc_results"</span>, <span class="st">"S1_fastqc.zip"</span>,  package <span class="op">=</span> <span class="st">"fastqcr"</span><span class="op">)</span></span>
<span><span class="va">qc.file</span></span>
<span><span class="co"># [1] "/Library/Frameworks/R.framework/Versions/3.3/Resources/library/fastqcr/fastqc_results/S1_fastqc.zip"</span></span></code></pre></div>
<p>We start by reading the output using the function <strong>qc_read</strong>(), which returns a list of tibbles containing the data for specified modules:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read all modules</span></span>
<span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/qc_read.html">qc_read</a></span><span class="op">(</span><span class="va">qc.file</span><span class="op">)</span></span>
<span><span class="co"># Elements contained in the qc object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qc</span><span class="op">)</span></span>
<span><span class="co">#  [1] "summary"                       "basic_statistics"             </span></span>
<span><span class="co">#  [3] "per_base_sequence_quality"     "per_tile_sequence_quality"    </span></span>
<span><span class="co">#  [5] "per_sequence_quality_scores"   "per_base_sequence_content"    </span></span>
<span><span class="co">#  [7] "per_sequence_gc_content"       "per_base_n_content"           </span></span>
<span><span class="co">#  [9] "sequence_length_distribution"  "sequence_duplication_levels"  </span></span>
<span><span class="co"># [11] "overrepresented_sequences"     "adapter_content"              </span></span>
<span><span class="co"># [13] "kmer_content"                  "total_deduplicated_percentage"</span></span></code></pre></div>
<p>The function <strong>qc_plot</strong>() is used to visualized the data of a specified module. Allowed values for the argument modules include one or the combination of:</p>
<ul>
<li>“Summary”,</li>
<li>“Basic Statistics”,</li>
<li>“Per base sequence quality”,</li>
<li>“Per sequence quality scores”,</li>
<li>“Per base sequence content”,</li>
<li>“Per sequence GC content”,</li>
<li>“Per base N content”,</li>
<li>“Sequence Length Distribution”,</li>
<li>“Sequence Duplication Levels”,</li>
<li>“Overrepresented sequences”,</li>
<li>“Adapter Content”</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/qc_plot.html">qc_plot</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"Per sequence GC content"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/qc_plot.html">qc_plot</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"Per base sequence quality"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/qc_plot.html">qc_plot</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"Per sequence quality scores"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/qc_plot.html">qc_plot</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"Per base sequence content"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/qc_plot.html">qc_plot</a></span><span class="op">(</span><span class="va">qc</span>, <span class="st">"Sequence duplication levels"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tools/README-qc-plot-1.png"><img src="tools/README-qc-plot-2.png"><img src="tools/README-qc-plot-3.png"><img src="tools/README-qc-plot-4.png"><img src="tools/README-qc-plot-5.png"></p>
</div>
<div class="section level2">
<h2 id="useful-links">Useful Links<a class="anchor" aria-label="anchor" href="#useful-links"></a>
</h2>
<ul>
<li>FastQC report for a <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html" class="external-link">good Illumina dataset</a>
</li>
<li>FastQC report for a <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html" class="external-link">bad Illumina dataset</a>
</li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/" class="external-link">Online documentation for each FastQC report</a></li>
</ul>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fastqcr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/kassambara/fastqcr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kassambara/fastqcr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fastqcr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alboukadel Kassambara <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/kassambara/fastqcr" class="external-link"><img src="https://api.travis-ci.org/kassambara/fastqcr.png" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=fastqcr" class="external-link"><img src="https://www.r-pkg.org/badges/version/fastqcr" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=fastqcr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/fastqcr" alt="Downloads"></a></li>
<li><a href="https://cranlogs.r-pkg.org/badges/grand-total/fastqcr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/fastqcr?color=orange" alt="Total Downloads"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
